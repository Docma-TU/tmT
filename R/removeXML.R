#' Removes XML tags and umlauts
#'
#' Removes XML tags and changes umlauts to a standardized form.
#'
#'
#' @param x \code{character} vector.
#' @param xml \code{logical} Should XML-TAGs be removed?
#' @param umlauts \code{logical}: Should umlauts be changed?
#' @param u.type Type of umlaut changing: \code{normal} for normal umlauts 
#' -> ue), \code{html} for html representation of umlauts (&uuml; -> ue) and
#' \code{all} for both.
#' @param html Logical: Should Numeric character references beeing deleted (after replacing umlauts etc.)
#' @details The decision which u.type is used should consider the language of the corpus, because in some languages the replacement of umlauts can change the meaning of the a word.
#' To change which columns are used by removeXML use argument xmlAction in \code{\link{readTextmeta}}.
#' @return Adjusted corpus
#' @keywords manip
#' @examples
#'
#'
#' ##---- Should be DIRECTLY executable !! ----
#' @export removeXML

removeXML <- function(x){
    x <- gsub(pattern="<[^><]*>", replacement=" ", x, perl=TRUE)
    x <- trimws(x)
    return(x)
}

#' @rdname removeXML
#' @export

removeUmlauts <- function(x){
    x <- gsub(pattern="\U00E4", replacement="ae",x)
    x <- gsub(pattern="\U00C4", replacement="Ae",x)
    x <- gsub(pattern="\U00F6", replacement="oe",x)
    x <- gsub(pattern="\U00D6", replacement="Oe",x)
    x <- gsub(pattern="\U00FC", replacement="ue",x)
    x <- gsub(pattern="\U00DC", replacement="Ue",x)
    x <- gsub(pattern="\U00DF", replacement="ss",x)
    return(x)
}

#' @rdname removeXML
#' @param dec logical remove html decimal?
#' @param hex logical remove html hex?
#' @param entity logical remove html name?
#' @param symbolList Which ISO-8859 Lists?
#' @param delete delete other entitys?
#' @param symbols check symbols?
#' @export

removeHTML <- function(x, dec=TRUE, hex=TRUE, entity=TRUE, symbolList=1, delete=TRUE, symbols=FALSE){
    entityList <- sort(unique(as.vector(ISO8859()[,symbolList])))
    entityList <- entityList[!duplicated(entityList),]

    if(!symbols){ # remove symbols from entityList
        symbolList <- paste0("00",as.hexmode(c(32:64,91:96,123:126,160:191,215,247)))
            entityList <- entityList[!entityList[,"htmlDec"] %in% symbolList,]
    }

    if(dec){cat("Decimal html \n")
        for(i in 1:nrow(entityList)){
            cat(entityList[i,"Character"], entityList[i,"htmlName"], "\n")
            x <- gsub(pattern=entityList[i,"htmlDec"], replacement=entityList[i,"Character"],x)}}

    if(hex){cat("Hex html \n")
        for(i in 1:nrow(entityList)){
            cat(entityList[i,"Character"], entityList[i,"htmlName"], "\n")
            x <- gsub(pattern=entityList[i,"htmlHex"], replacement=entityList[i,"Character"],x)}}

    if(entity){cat("Entity html \n")
        for(i in 1:nrow(entityList)){
            cat(entityList[i,"Character"], entityList[i,"htmlName"], "\n")
            x <- gsub(pattern=entityList[i,"htmlName"], replacement=entityList[i,"Character"],x)}}
    if(delete) x <- gsub(pattern="&[^;]*;", replacement="", x)
    x <- trimws(x)
    return(x)
}

ISO8859 <- function(){
ISO <- matrix(c(
"00A0","00A0","00A0","00A0","00A0","00A0","00A0","00A0","00A0","00A0","00A0","","00A0","00A0","00A0","00A0",
"00A1","0104","0126","0104","0401","00A0","2018","00A0","00A1","0104","0E01","","201D","1E02","00A1","0104",
"00A2","02D8","02D8","0183","0402","00A0","2019","00A2","00A2","0112","0E02","","00A2","1E03","00A2","0105",
"00A3","0141","00A3","0156","0403","00A0","00A3","00A3","00A3","0122","0E03","","00A3","00A3","00A3","0141",
"00A4","00A4","00A4","00A4","0404","00A0","00A0","00A4","00A4","012A","0E04","","00A4","010A","20AC","20AC",
"00A5","013D","00A0","0128","0405","00A0","00A0","00A5","00A5","0128","0E05","","20E1","010B","00A5","201E",
"00A6","015A","0124","013B","0406","00A0","00A6","00A6","00A6","0136","0E06","","00A6","1E0A","0160","0160",
"00A7","00A7","00A7","00A7","0407","00A0","00A7","00A7","00A7","00A7","0E07","","00A7","00A7","00A7","00A7",
"00A8","00A8","00A8","00A8","0408","00A0","00A8","00A8","00A8","013B","0E07","","00D8","1E80","0161","0161",
"00A9","0160","0130","0160","04A9","00A0","00A9","00A9","00A9","0110","0E09","","00A9","00A9","00A9","00A9",
"00AA","015E","015E","0112","040A","00A0","00A0","00D7","00AA","0160","0E0A","","0156","1E82","00AA","0218",
"00AB","0164","011E","0122","040B","00A0","00AB","00AB","00AB","0166","0E0B","","00AB","1E0B","00AB","00AB",
"00AC","0179","0134","0166","040C","060C","00AC","00AC","00AC","017D","0E0C","","00AC","1EF2","00AC","0179",
"00AD","00AD","00AD","00AD","00AD","00AD","00AD","00AD","00AD","00AD","0E0D","","00AD","00AD","00AD","00AD",
"00AE","017D","00A0","017D","040E","00A0","00A0","00AE","00AE","016A","0E0E","","00AE","00AE","00AE","017A",
"00AF","017B","017B","00AF","040F","00A0","2015","203E","00AF","0145","0E0F","","00C6","0178","00AF","017B",
"00B0","00B0","00B0","00B0","0410","00A0","0410","00B0","00B0","00B0","0E10","","00B0","1E1E","00B0","00B0",
"00B1","0105","0127","0105","0411","00A0","00B1","00B1","00B1","0105","0E11","","00B1","1E1F","00B1","00B1",
"00B2","02DB","00B2","02DB","0412","00A0","00B2","00B2","00B2","0113","0E12","","00B2","0120","00B2","010C",
"00B3","0142","00B3","0157","0413","00A0","00B3","00B3","00B3","0123","0E13","","00B3","0121","00B3","0142",
"00B4","00B4","00B4","00B4","0414","00A0","0384","00B4","00B4","012B","0E14","","201C","1E40","017D","017D",
"00B5","013E","00B5","0129","0415","00A0","0385","00A0","00B5","0129","0E15","","00B5","1E41","00B5","201D",
"00B6","015B","0125","013C","0416","00A0","0386","00B6","00B6","0137","0E16","","00B6","00B6","00B6","00B6",
"00B7","02C7","00B7","02C7","0417","00A0","00B7","00B7","00B7","00B7","0E17","","00B7","1E56","00B7","00B7",
"00B8","00B8","00B8","00B8","0418","00A0","0338","00B8","00B8","013C","0E18","","00F8","1E81","017E","017E",
"00B9","0161","0131","0161","0419","00A0","0339","00B9","00B9","0111","0E19","","00B9","1E57","00B9","010D",
"00BA","015F","015F","0113","041A","00A0","033A","00F7","00BA","0161","0E1A","","0157","1E83","00BA","0219",
"00BB","0165","011F","0123","041B","061B","033B","00BB","00BB","0167","0E1B","","00BB","1E60","00BB","00BB",
"00BC","0165","0135","0167","041C","00A0","033C","00BC","00BC","017E","0E1C","","00BC","1EF3","0152","0152",
"00BD","02DD","00BD","014A","041D","00A0","00BD","00BD","00BD","2015","0E1D","","00BD","1E84","0153","0153",
"00BE","017E","00A0","017E","041E","00A0","033E","00BE","00BE","016B","0E1E","","00BE","1E85","0178","0178",
"00BF","017C","017C","014B","041F","061F","033F","00A0","00BF","014B","0E1F","","00E6","1E61","00BF","017C",
"00C0","0154","00C0","0100","0420","00A0","0390","00A0","00C0","0100","0E20","","0104","00C0","00C0","00C0",
"00C1","00C1","00C1","00C1","0421","0621","0391","00A0","00C1","00C1","0E21","","012E","00C1","00C1","00C1",
"00C2","00C2","00C2","00C2","0422","0622","0392","00A0","00C2","00C2","0E22","","0100","00C2","00C2","00C2",
"00C3","0102","00A0","00C3","0423","0623","0393","00A0","00C3","00C3","0E23","","0106","00C3","00C3","0102",
"00C4","00C4","00C4","00C4","0424","0624","0394","00A0","00C4","00C4","0E24","","00C4","00C4","00C4","00C4",
"00C5","0139","010A","00C5","0425","0625","0395","00A0","00C5","00C5","0E25","","00C5","00C5","00C5","0106",
"00C6","0106","0108","00C6","0426","0626","0396","00A0","00C6","00C6","0E26","","0118","00C6","00C6","00C6",
"00C7","00C7","00C7","012E","0427","0627","0397","00A0","00C7","012E","0E27","","0112","00C7","00C7","00C7",
"00C8","010C","00C8","010C","0428","0628","0398","00A0","00C8","010C","0E28","","010C","00C8","00C8","00C8",
"00C9","00C9","00C9","00C9","0429","0629","0399","00A0","00C9","00C9","0E29","","00C9","00C9","00C9","00C9",
"00CA","0118","00CA","0118","042A","062A","039A","00A0","00CA","0118","0E2A","","0179","00CA","00CA","00CA",
"00CB","00CB","00CB","00CB","042B","062B","039B","00A0","00CB","00CB","0E2B","","0116","00CB","00CB","00CB",
"00CC","011A","00CC","0116","042C","062C","039C","00A0","00CC","0116","0E2C","","0122","00CC","00CC","00CC",
"00CD","00CD","00CD","00CD","042D","062D","039D","00A0","00CD","00CD","0E2D","","0136","00CD","00CD","00CD",
"00CE","00CE","00CE","00CE","042E","062E","039E","00A0","00CE","00CE","0E2E","","012A","00CE","00CE","00CE",
"00CF","010E","00CF","012A","042F","062F","039F","00A0","00CF","00CF","0E2F","","013B","00CF","00CF","00CF",
"00D0","00D0","00D0","00D0","0430","0630","03A0","00A0","011E","00D0","0E30","","0160","0174","00D0","00D0",
"00D1","0143","00D1","0145","0431","0631","03A1","00A0","00D1","0145","0E31","","0143","00D1","00D1","0143",
"00D2","0147","00D2","014C","0432","0632","00A0","00A0","00D2","014C","0E32","","0145","00D2","00D2","00D2",
"00D3","00D3","00D3","0136","0433","0633","03A3","00A0","00D3","00D3","0E33","","00D3","00D3","00D3","00D3",
"00D4","00D4","00D4","00D4","0434","0634","03A4","00A0","00D4","00D4","0E34","","014C","00D4","00D4","00D4",
"00D5","0150","0120","00D5","0435","0635","03A5","00A0","00D5","00D5","0E35","","00D5","00D5","00D5","0150",
"00D6","00D6","00D6","00D6","0436","0636","03A6","00A0","00D6","00D6","0E36","","00D6","00D6","00D6","00D6",
"00D7","00D7","00D7","00D7","0437","0637","03A7","00A0","00D7","0168","0E37","","00D7","1E6A","00D7","015A",
"00D8","0158","011C","00D8","0438","0638","03A8","00A0","00D8","00D8","0E38","","0172","00D8","00D8","0170",
"00D9","016E","00D9","0172","0439","0639","03A9","00A0","00D9","0172","0E39","","0141","00D9","00D9","00D9",
"00DA","00DA","00DA","00DA","043A","063A","03AA","00A0","00DA","00DA","0E3A","","015A","00DA","00DA","00DA",
"00DB","0170","00D8","00DB","034B","00A0","03AB","00A0","00DB","00DB","00A0","","016A","00DB","00DB","00DB",
"00DC","00DC","00DC","00DC","034C","00A0","03AC","00A0","00DC","00DC","00A0","","00DC","00DC","00DC","00DC",
"00DD","00DD","016C","0168","034D","00A0","03AD","00A0","0130","00DD","00A0","","017B","00DD","00DD","0118",
"00DE","0162","015C","016A","034E","00A0","03AE","00A0","015E","00DE","00A0","","017D","0176","00DE","021A",
"00DF","00DF","00DF","00DF","034F","00A0","03AF","2017","00DF","00DF","0E3F","","00DF","00DF","00DF","00DF",
"00E0","0155","00E0","0101","0440","0640","03B0","05D0","00E0","0101","0E40","","0105","00E0","00E0","00E0",
"00E1","00E1","00E1","00E1","0441","0641","03B1","05D1","00E1","00E1","0E41","","012F","00E1","00E1","00E1",
"00E2","00E2","00E2","00E2","0442","0642","03B2","05D2","00E2","00E2","0E42","","0101","00E2","00E2","00E2",
"00E3","0103","00A0","00E3","0443","0643","03B3","05D3","00E3","00E3","0E43","","0107","00E3","00E3","0103",
"00E4","00E4","00E4","00E4","0444","0644","03B4","05D4","00E4","00E4","0E44","","00E4","00E4","00E4","00E4",
"00E5","0013A","010B","00E5","0445","0645","03B5","05D5","00E5","00E5","0E45","","00E5","00E5","00E5","0107",
"00E6","0107","0109","00E6","0446","0646","03B6","05D6","00E6","00E6","0E46","","0119","00E6","00E6","00E6",
"00E7","00E7","00E7","012F","0447","0647","03B7","05D7","00E7","012F","0E47","","0113","00E7","00E7","00E7",
"00E8","010D","010D","010D","0448","0648","03B8","05D8","00E8","010D","0E48","","010D","00E8","00E8","00E8",
"00E9","00E9","00E9","00E9","0449","0649","03B9","05D9","00E9","00E9","0E49","","00E9","00E9","00E9","00E9",
"00EA","0119","00EA","0119","044A","064A","03BA","05DA","00EA","0119","0E4A","","017A","00EA","00EA","00EA",
"00EB","00EB","00EB","00EB","044B","064B","03BB","05DB","00EB","00EB","0E4B","","0117","00EB","00EB","00EB",
"00EC","011B","00EC","0117","044C","064C","03BC","05DC","00EC","0117","0E4C","","0123","00EC","00EC","00EC",
"00ED","00ED","00ED","00ED","044D","064D","03BD","05DD","00ED","00ED","0E4D","","0137","00ED","00ED","00ED",
"00EE","00EE","00EE","00EE","044E","064E","03BE","05DE","00EE","00EE","0E4E","","012B","00EE","00EE","00EE",
"00EF","010F","00EF","00EF","044F","064F","03BF","05DF","00EF","00EF","0E4F","","013C","00EF","00EF","00EF",
"00F0","0111","00A0","0111","2116","0640","03C0","05E0","011F","00F0","0E50","","0161","0175","00F0","0111",
"00F1","0144","00F1","0146","0451","0641","03C1","05E1","00F1","0146","0E51","","0144","00F1","00F1","0144",
"00F2","0148","00F2","014D","0452","0642","03C2","05E2","00F2","014D","0E52","","0146","00F2","00F2","00F2",
"00F3","00F3","00F3","0137","0453","00A0","03C3","05E3","00F3","00F3","0E53","","00F3","00F3","00F3","00F3",
"00F4","00F4","00F4","00F4","0454","00A0","03C4","05E4","00F4","00F4","0E54","","014D","00F4","00F4","00F4",
"00F5","0151","0121","00F5","0455","00A0","03C5","05E5","00F5","00F5","0E55","","00F5","00F5","00F5","0151",
"00F6","00F6","00F6","00F6","0456","00A0","03C6","05E6","00F6","00F6","0E56","","00F6","00F6","00F6","00F6",
"00F7","00F7","00F7","00F7","0457","00A0","03C7","05E7","00F7","0169","0E57","","00F7","1E6B","00F7","015B",
"00F8","0159","011D","00F8","0458","00A0","03C8","05E8","00F8","00F8","0E58","","0173","00F8","00F8","0171",
"00F9","016F","00F9","0173","0459","00A0","03C9","05E9","00F9","0173","0E59","","0142","00F9","00F9","00F9",
"00FA","00FA","00FA","00FA","045A","00A0","03CA","05EA","00FA","00FA","0E5A","","015B","00FA","00FA","00FA",
"00FB","0171","00FB","00FB","045B","00A0","03CB","00A0","00FB","00FB","0E5B","","016B","00FB","00FB","00FB",
"00FC","00FC","00FC","00FC","045C","00A0","03CC","00A0","00FC","00FC","00A0","","00FC","00FC","00FC","00FC",
"00FD","00FD","016D","0169","00A7","00A0","03CD","00A0","0131","00FD","00A0","","017C","00FD","00FD","0119",
"00FE","0163","015D","016B","045E","00A0","03CE","00A0","015F","00FE","00A0","","017E","0177","00FE","021B",
"00FF","02D9","02D9","02D9","045F","00A0","00A0","00A0","00FF","0138","00A0","","2019","00FF","00FF","00FF"
), byrow=TRUE, ncol=16)
return(ISO)
}
